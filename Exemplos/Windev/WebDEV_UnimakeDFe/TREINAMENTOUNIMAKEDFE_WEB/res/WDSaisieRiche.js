/*! 28.0.2.0 */
/*! VersionVI: 01F280095g   */
var WDSaisieRiche=function(){"use strict";function f(n,t){var f=clWDUtil.tabHTML2RVBA(n),u=clWDUtil.sRVB2HTML(f).substr(1).toLowerCase(),i=t.querySelector(".wbColorPickerChoice"+u);i||(i=t.querySelector(".wbColorPickerChoice"+u.toUpperCase()));i&&r(i,t)}function r(n,t){var i=t.querySelector(".wbColorPickerChoiceChecked");i&&i.classList.remove("wbColorPickerChoiceChecked");n.classList.add("wbColorPickerChoiceChecked")}function n(n,t,i,r,u){if(arguments.length){WDBarre.prototype.constructor.apply(this,arguments);this.m_tabBoutonsInfo&&this.m_tabBoutonsInfo.UND!==undefined&&(this.m_tabBoutonsInfo.RED=this.m_tabBoutonsInfo.UND);this.m_bBaliseP=u[6];this.m_bModeEmail=!!u[7];this.m_bModeSansStyleWB=this.m_bModeEmail?!1:!!u[8];var f=this;this.m_fKeyDown=function(n){return f.bOnKeyDown(n)};this.m_fRafBarreTrueMasqueAutre=function(n){return f.__RafBarreMasqueAutre(n||event)};this.m_fRafBarreSans=function(n){return f.RafBarre(n||event)}}}function u(n,t,i,r){for(var o=t.length,f,e,u=0;u<o;u++)(f=t[u],e=n[f],r&&"0"==e.charAt(0))||(i[f]=e)}var i=bIE?function(n,t){return n.isEqual(t)}:function(n,t){return n.compareBoundaryPoints(0,t)==0&&n.compareBoundaryPoints(2,t)==0},e=function(){function n(n,t,i,r){arguments.length&&WDBarreBouton.prototype.constructor.apply(this,[n,t,i,r])}return n.prototype=new WDBarreBouton,n.prototype.constructor=n,n}(),o=function(){function n(n,t,i,r,u){arguments.length&&(WDBarreBoutonOnOff.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i,!1,null]]),this.m_sStyle=r,this.m_tabStyleValeur=u)}return n.prototype=new WDBarreBoutonOnOff,n.prototype.constructor=n,n.prototype.__DessineEtat=function(n,t,i){WDBarreBouton.prototype.__DessineEtat.apply(this,arguments);this.m_oObjetParent.bRelookUL()&&(n==this.ms_eEtatActif?(i.classList.add("wbActif"),i.firstElementChild.classList.add("wbActif"),i.firstElementChild.firstElementChild.classList.add("wbActif")):(i.classList.remove("wbActif"),i.firstElementChild.classList.remove("wbActif"),i.firstElementChild.firstElementChild.classList.remove("wbActif")))},n.prototype.ExecuteCommande=function(n){var t=this.m_oObjetParent.oGetParamEtat(n,!1);if(t[0]&&this.m_sStyle!="textAlign"){if(this.m_oRange&&(delete this.m_oRange,delete this.m_bForceActif),this.m_sStyle)switch(this._veGetEtatSpecifique(n,this.ms_eEtatNormal,t)){case this.ms_eEtatNormal:this.m_bForceActif=!0;break;case this.ms_eEtatActif:this.m_bForceActif=!1}this.m_oRange=t[0]}WDBarreBoutonOnOff.prototype.ExecuteCommande.apply(this,arguments)},n.prototype.bActif=function(n,t){if(this.m_oRange){try{if(i(this.m_oRange,t[0]))return this.m_bForceActif}catch(r){}delete this.m_oRange;delete this.m_bForceActif}if(this.m_sStyle&&t[2]&&this.m_sStyle.length)switch(this.m_oParamCommande[0]){case"italic":if(this.__bStyleMatchRecursif(t[1],"em"))return!0;break;case"underline":if(this.__bStyleMatchRecursif(t[1],"u"))return!0;break;case"strikeThrough":if(this.__bStyleMatchRecursif(t[1],"strike"))return!0;break;case"bold":if(t[2][this.m_sStyle]=="normal")return!1;default:if(this.__bStyleMatch(t[2][this.m_sStyle]))return!0}return!1},n.prototype.__bStyleMatchRecursif=function(n,t){while(n&&n!=this.m_oObjetParent.m_oData&&n.nodeType!==Node.DOCUMENT_NODE){if(this.__bStyleMatch(clWDUtil.oGetCurrentStyle(n)[this.m_sStyle])||n.tagName&&clWDUtil.bBaliseEstTag(n,t))return!0;n=n.parentNode}return!1},n.prototype.__bStyleMatch=function(n){for(var r=this.m_tabStyleValeur.length,t,i=0;i<r;i++)if(t=this.m_tabStyleValeur[i],t)if(t.bTst){if(n.indexOf(t.sVal)!=-1)return!0}else if(n!=t.sVal)return!0;return!1},n}(),s=function(){function n(n,t,i,r,u,f){var h,o,s,e,c,a,l;if(arguments.length){if(WDBarreBoutonPopup.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i,!1,null],r]),this.m_sStyle=f,h=this,document.body.addEventListener("click",this.m_oBouton.onmouseout),document.body.addEventListener("keydown",function(n){n.keyCode==27&&(h.m_oBouton.onmouseout.apply(this,arguments),h.m_oObjetParent.SetFocus())}),window.addEventListener("blur",this.m_oBouton.onmouseout),o=HTML_TOOLBAR[u],o)for(s=r.getElementsByTagName("span"),this.m_oObjetParent.bRelookUL()&&(o=[HTML_TOOLBAR.COSP[0]].concat(Object.keys(o).map(function(n){return o[n]}))),e=0,c=s.length,e=0;e<c;e++)a=s[e],clWDUtil.SupprimeFils(s[e]),o[e]!==undefined&&s[e].appendChild(document.createTextNode(o[e]));this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"&&!r.querySelector("input")&&(l=$(r).find("tr").first(),l.parent().append($('<tr><td style="padding:6px;"><label><input type="checkbox" checked/> '+HTML_TOOLBAR.DLG.TSY+"<\/label><\/td><\/tr>")))}}function t(n){return clWDUtil.sRVB2HTML(clWDUtil.tabHTML2RVBA(n))}return n.prototype=new WDBarreBoutonPopup,n.prototype.constructor=n,n.prototype.OnMouseLeave=function(n){var t,i;this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"&&(t=clWDUtil.oGetTarget(n),t&&t.firstElementChild&&t.firstElementChild.tagName.toLocaleLowerCase()!=="div"&&(i=$(t).find("div"),i.css("background","")))},n.prototype.OnMouseEnter=function(n){var t,i,r;if(this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"&&(t=clWDUtil.oGetTarget(n),t&&t.firstElementChild&&t.firstElementChild.tagName.toLocaleLowerCase()==="div")){var u=$(t),e=u.closest("td").index(),o=u.closest("tr").index(),f=u.closest("table"),s=f.find("div");for(s.css("background",""),i=0;i<=o;++i)for(r=0;r<=e;++r)f.find("tr").eq(i).find("div").eq(r).css("background","goldenrod")}},n.prototype.OnClickP=function(n){var i=clWDUtil.oGetTarget(n),u=clWDUtil.oGetOriginalTarget2(n),e;if(this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"){if(u&&u.firstElementChild&&u.firstElementChild.tagName.toLocaleLowerCase()==="div"){var f=$(i),o=f.closest("td").index(),s=f.closest("tr").index();this.m_oParamCommande[2]=[o+1,s+1];e=f.closest(".WDBarreOutilsPopup").find("input").get(0).checked;this.m_oParamCommande[3]=e;WDBarreBouton.prototype.ExecuteCommande.apply(this,[n])}}else this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0].indexOf("Color")>0&&clWDUtil.bBaliseEstTag(i,"div")&&(this.m_oParamCommande[2]=this.m_oObjetParent.bRelookUL()&&this.m_sStyle=="backgroundColor"?clWDUtil.sRVBA2HTML(clWDUtil.tabHTML2RVBA(clWDUtil.oGetCurrentStyle(i).backgroundColor)):t(clWDUtil.oGetCurrentStyle(i).backgroundColor),WDBarreBouton.prototype.ExecuteCommande.apply(this,[n]),r(i,this.m_oBouton));WDBarreBoutonPopup.prototype.OnClickP.apply(this,arguments)},n.prototype.OnMouseOut=function(n){var t=n.type!="mouseout"?clWDUtil.oGetTarget(n):bIE?n.toElement:n.relatedTarget;t!=window&&clWDUtil.bEstFils(t,this.m_oBouton)||(n.type!="mouseout"&&this.__SetDisplayPopup(!1),WDBarreBouton.prototype.OnMouseOut.apply(this,arguments))},n.prototype._veGetEtatSpecifique=function(n,t,i){return this.m_sStyle&&i[2]&&i[2][this.m_sStyle]&&f(i[2][this.m_sStyle],this.m_oBouton),t},n.prototype.__DessineEtat=function(n,t,i,r){n!=t.m_eEtat&&(n!=this.ms_eEtatNormal?t.m_eEtat=n:delete t.m_eEtat,i.style.backgroundColor=this.m_oObjetParent.sGetCouleurFond(n),r[2]&&this.m_oObjetParent.bRelookUL()&&(i.style.color=r[2][this.m_sStyle]))},n}(),t=function(){function n(n,t,i,r,u,f){var s,e,a,h,o,c,l;if(arguments.length){for(this.m_oObjetParent=n,this.m_oCombo=t,this.m_sCommande=i,this.m_sStyle=r,this.m_oCombo.options&&this.m_oCombo.options.length&&(this.m_oCombo.options.length=0),s=HTML_TOOLBAR[f],a=u.length,e=0;e<a;e++)if(h=u[e],clWDUtil.isArray(h))o=e,s&&s[e]&&(o=s[e]),this.ajouteOption(o,h);else if(h){if(this.m_oObjetParent.bRelookUL()&&h.bMasquerEnRelookUL)continue;o=h.sN;s&&s[e]&&(this.m_oObjetParent.bRelookUL()?o=s[e]:(c=s[e],l=" ("+o+")",f=="FHE"?e==0&&(c=HTML_TOOLBAR.FSI[1]):f=="FSI"&&(c="",l=parseInt(o)),o=c+l));this.ajouteOption(o,h.sV||h)}(n.bRelookUL()||!n.bGestionTableZR())&&this.vPostPlaceBarre()}}function t(n){for(var i=n.split(","),u=i.length,r,t=0;t<u;t++){for(r=i[t].length;r>0&&(i[t].charAt(0)=="'"||i[t].charAt(0)==" ");)i[t]=i[t].substring(1),r--;while(r>0&&(i[t].charAt(r-1)=="'"||i[t].charAt(r-1)==" "))i[t]=i[t].substring(0,r-1),r--}return i}return n.prototype.vPrePlaceBarre=function(){this.m_oCombo.onchange=null},n.prototype.vPostPlaceBarre=function(){var n=this;this.m_oCombo.onchange=function(t){n.OnChange(t||event)}},n.prototype.OnChange=function(n){var t=this.m_oObjetParent.oGetRange();t&&(this.m_oRange=t);this.m_oObjetParent.ExecuteCommande(n,[this.m_sCommande,!1,this.m_oCombo.options[this.m_oCombo.selectedIndex].value])},n.prototype.RafEtatSimple=function(n){this.RafEtat(n,this.m_oObjetParent.oGetParamEtat(n,!1))},n.prototype.RafEtat=function(n,t){if(this.m_oRange){try{i(this.m_oRange,t[0])}catch(u){}delete this.m_oRange}if(t[2]){var r=t[2][this.m_sStyle];switch(this.m_sCommande){case"FontSize":this.__RafEtat_Taille(n,r);break;case"FontName":r&&r[0]=='"'&&r[r.length-1]=='"'&&(r=r.substr(1,r.length-2));r=r.replace(/"/g,"'");this.__RafEtat_Police(n,r);break;case"FormatBlock":this.__RafEtat_Format(n,t[1])}}},n.prototype.__RafEtat_Taille=function(n,t){var i,f,e;t=t.replace(/'/g,"");var o=t,u=this.m_oObjetParent.bRelookUL()?function(n){return!this.m_oObjetParent.m_tabDescBarre.filter(function(n){return n.sSuf=="FSI"})[0].tabP.filter(function(t){return t.sN==n})[0].bMasquerEnRelookUL}.bind(this):function(){return!0},r=function(n,t,i,r){return u(n)?t<i?!0:t<r&&(!u(n+1)||r-t>t-i)?!0:!1:!1};t.charAt(t.length-2)=="p"&&(i=parseFloat(t),t.charAt(t.length-1)=="t"&&(i*=96/72),r(1,i,11.5,14.5)?t="1":r(2,i,14.5,17)?t="2":r(3,i,17,21)?t="3":r(4,i,21,28)?t="4":r(5,i,28,40)?t="5":r(6,i,40,48)?t="6":u(7)&&(t="7"));f=this.__tabRechercheValeurCombo(t,function(n,t){return n.toUpperCase()==t.toUpperCase()});f.length>0&&(e=f[0]);this.__Selection(e,o)},n.prototype.__RafEtat_Police=function(n,i){var r=t(i),e=r.join(","),h=function(n,i){return n.toUpperCase()==t(i)[0].toUpperCase()},u,o=this.__tabRechercheValeurCombo(r[0],h),f,s;if(o.length>0){for(s=o.length,f=0;f<s;f++)if(e.toUpperCase().indexOf(t(this.getOptionValue(o[f])).join(",").toUpperCase())==0){u=o[f];break}u===undefined&&(u=this.ajouteOption(r.length?r[0]:r[0]+"("+e+")",e))}else u=this.ajouteOption(r[0],e);this.__Selection(u,r[0])},n.prototype.__RafEtat_Format=function(n,t){var r;if(!bIE||!n||!clWDUtil.bBaliseEstTag(n.srcElement,"select")){for(var u=0,f=this.m_oObjetParent.m_oData,i="";t&&t!=f;){if(i="<"+clWDUtil.sGetTagName(t)+">",r=this.__tabRechercheValeurCombo(i,function(n,t){return n==t}),0<r.length){u=r[0];break}i="";t=t.parentNode}this.__Selection(u,i.length?i:"")}},n.prototype.__tabRechercheValeurCombo=function(n,t){for(var r=[],u=this.m_oCombo.childElementCount,i=0;i<u;i++)t(n,this.getOptionValue(i))&&r.push(i);return r},n.prototype.__Selection=function(n){this.m_oCombo.selectedIndex!=n&&(this.m_oCombo.selectedIndex=n)},n.prototype.getOptionValue=function(n){return this.m_oCombo.options[n].value},n.prototype.ajouteOption=function(n,t){return this.m_oCombo.options[this.m_oCombo.childElementCount]=new Option(n,t),this.m_oCombo.childElementCount-1},n}(),h=function(){function n(n,i,r,u,f,e,o){var c,l,h,a,s;for(this.m_domInputCombo=i.previousElementSibling.previousElementSibling,this.m_domLabelReplie=i.previousElementSibling,this.m_sSuffixe=e,t.prototype.constructor.apply(this,arguments),!bTouchMobile&&o&&(c=this.m_domLabelReplie.getAttribute("for").replace("CHECKBOX","INPUT"),this.m_domInputCombo.parentElement.lastElementChild.id===c||(this.m_domInputSaisie=document.createElement("input"),this.m_domInputSaisie.type="text",this.m_domInputSaisie.id=c,this.m_domInputCombo.parentElement.append(this.m_domInputSaisie),this.m_domInputCombo.addEventListener("keydown",function(n){n.stopPropagation();n.code==="Escape"?(n.preventDefault(),this.m_domInputCombo.blur()):(n.preventDefault(),this.m_domInputSaisie.focus(),this.m_domInputSaisie.value=n.key.length===1?n.key:"")}.bind(this)),this.m_domInputSaisie.addEventListener("focus",function(){this.m_domInputSaisie.select()}.bind(this)),this.m_domInputSaisie.addEventListener("change",function(n){this.m_domInputSaisie.value.length&&this.OnChange(n,this.m_domInputSaisie.value)}.bind(this)),this.m_domInputSaisie.addEventListener("keydown",function(n){n.stopPropagation();n.code==="Escape"?(n.preventDefault(),this.m_domInputSaisie.value="",this.m_domInputSaisie.blur(),this.m_oObjetParent.m_oDocument.body.focus()):(n.code==="Enter"||n.code==="NumpadEnter")&&(n.preventDefault(),this.OnChange(n,this.m_domInputSaisie.value),this.m_domInputSaisie.blur())}.bind(this)))),l=0,a=n.m_tabDescBarre.length,h=0;h<a;h++)if(s=n.m_tabDescBarre[h],s&&s.sCom==r){l=s.nIndiceSelectionDefaut||0;this.__Selection(l,s.sV);break}}return n.prototype=new t,n.prototype.constructor=n,n.prototype.nGetFontSizeCssPxFromFontSizeHtml=function(n){switch(+n){case 1:return 10;case 2:return 13;case 3:return 16;case 4:return 18;case 5:return 24;case 6:return 32;case 7:return 48;default:return+n}},n.prototype.ajouteOption=function(n,t){var c,o,e,i,r,s,u,h,f;if(this.m_sCommande=="wbEmoji"&&clWDUtil.isObject(t)){if(this.m_oObjetParent.m_tabBoutonsInfo[this.m_sSuffixe]&&this.m_oObjetParent.m_tabBoutonsInfo[this.m_sSuffixe].bVisible===!1)return;c=this;this.m_oCombo.classList.contains("wbBarreOutilsComboListeDroite")||(this.m_oCombo.classList.add("wbBarreOutilsComboListeDroite"),this.m_domInputCombo.addEventListener("change",function(){this.m_oCombo.classList.add("wbBarreOutilsComboListeDroite");this.m_oCombo.getBoundingClientRect().x<0&&this.m_oCombo.classList.remove("wbBarreOutilsComboListeDroite")}.bind(this)));for(o in t)e=document.createElement("li"),e.setAttribute("class","wbBarreOutilsComboListeOption"),i=document.createElement("label"),i.setAttribute("for",c.m_domInputCombo.id),i.setAttribute("class","wbBarreOutilComboLabel"),r=document.createElement("span"),r.setAttribute("class","wbSaisirRicheOptionValueInnerHTML"),r.setAttribute("title",clWDUtil.sEncodeInnerHTML(t[o],!0)),r.appendChild(document.createTextNode(String.fromCodePoint(parseInt("0"+o.substr(2,6),16)))),i.appendChild(r),e.appendChild(i),this.m_oCombo.appendChild(e)}else{s=this.m_sCommande=="FormatBlock"?t.substr(4,t.length-8):"span";u='<li class="wbBarreOutilsComboListeOption"><label for="'+this.m_domInputCombo.id+'" class="wbBarreOutilComboLabel"><'+s;switch(this.m_sCommande){case"FontSize":typeof t=="string"&&(isNaN(+t)?t.indexOf("px")>-1?f=parseFloat(t):h=t:f=this.nGetFontSizeCssPxFromFontSizeHtml(+t),f&&(h=clWDUtil.bRWD?f/16+"rem":f+"px"));u+=' style="font-family:Helvetica,Arial,sans-serif;font-size:'+h+';"';break;case"FontName":u+=" style=\"font-family:'"+t.split(",").join("','")+"';\"";break;case"FormatBlock":u+=' style="font-family:Helvetica,Arial,sans-serif;"'}this.m_oCombo.innerHTML+=u+' data-wbSaisieRicheOptionValue="'+t.replace(/"/g,"&quot;")+'">'+n+"<\/"+s+"><\/label><\/li>"}return this.m_oCombo.childElementCount-1},n.prototype.getOptionValue=function(n){var t=clWDUtil.isObject(n)?n:this.m_oCombo.children[n];return t.firstElementChild.firstElementChild.classList.contains("wbSaisirRicheOptionValueInnerHTML")?t.firstElementChild.firstElementChild.innerHTML:t.firstElementChild.firstElementChild.dataset.wbsaisiericheoptionvalue.replace(/&quot;/g,'"')},n.prototype.vPrePlaceBarre=function(){this.m_oCombo.onmousedown=null},n.prototype.vPostPlaceBarre=function(){var n=this;this.m_oCombo.onmousedown=function(t){n.OnChange(t||event)}},n.prototype.OnChange=function(n,t){var i=clWDUtil.oGetTarget(n),f,r,u;(clWDUtil.bBaliseEstTag(i,"input")&&(i=this.m_domLabelReplie.nextElementSibling.firstElementChild),i.parentNode&&clWDUtil.bBaliseEstTag(i.parentNode,"label")&&(i=i.parentNode),clWDUtil.bBaliseEstTag(i,"label")&&(i=i.parentNode),clWDUtil.bBaliseEstTag(i,"li"))&&(f=this.m_oObjetParent.oGetRange(),f&&(this.m_oRange=f),this.m_oObjetParent.ExecuteCommande(n,[this.m_sCommande,!1,t!==undefined?t:this.getOptionValue(i)]),"FormatBlock"==this.m_sCommande&&(r=clWDUtil.oGetCurrentStyle(i.firstElementChild.firstElementChild),u=this.m_oObjetParent.oGetParamEtat(n,!1)[2],r.fontWeight!=u.fontWeight&&this.m_oObjetParent.ExecuteCommande(n,["bold",!1,r.fontWeight!="normal"&&r.fontWeight!="400"]),r.fontStyle!=u.fontStyle&&this.m_oObjetParent.ExecuteCommande(n,["italic",!1,r.fontStyle.indexOf("normal")==-1]),r.textDecoration!=u.textDecoration&&this.m_oObjetParent.ExecuteCommande(n,[r.textDecoration.indexOf("none")==-1,!1,null])),this.m_oObjetParent.RafBarre(n,!0))},n.prototype.__Selection=function(n,t){var r=n,u,f,i,e;clWDUtil.isObject(n)||(r=this.m_oCombo.children[n]);r&&(u=r.firstElementChild,this.m_domLabelReplie.innerHTML=u.innerHTML,this.m_domLabelReplie.removeAttribute("title"),this.m_domLabelReplie.firstElementChild&&this.m_domLabelReplie.firstElementChild.removeAttribute("title"),f=this.m_oCombo.querySelector(".wbBarreOutilComboLabelActif"),f&&f.classList.remove("wbBarreOutilComboLabelActif"),u.classList.add("wbBarreOutilComboLabelActif"),!bEdge&&r.scrollIntoView&&(i=$(this.m_oObjetParent.m_oHote).closest(".dzSpanRiche,.dzSpan"),i.length||(i=$(window)),e=i.scrollTop(),r.scrollIntoView(),i.get(0).scrollTo(i.scrollLeft(),e)));this.m_domInputSaisie&&(t&&t.length&&this.m_domLabelReplie.firstElementChild&&(this.m_domLabelReplie.firstElementChild.innerText=t),document.activeElement!==this.m_domInputSaisie&&(this.m_domInputSaisie.value=t))},n}();n.prototype=new WDBarre;n.prototype.constructor=n;var c="_EDT",l=["borderTopWidth","borderTopStyle","borderTopColor","borderLeftWidth","borderLeftStyle","borderLeftColor","borderRightWidth","borderRightStyle","borderRightColor","borderBottomWidth","borderBottomStyle","borderBottomColor"],a=["paddingLeft","paddingTop","paddingRight","paddingBottom"],v=WDSaisieRiche_ms_tabEmojis;return n.prototype.m_tabDescBarre=[{nType:0,sSuf:"GRA",sCom:"bold",sSty:"fontWeight",tabP:[{sVal:"400",bTst:!1}]},{nType:0,sSuf:"ITA",sCom:"italic",sSty:"fontStyle",tabP:[{sVal:"italic",bTst:!0},{sVal:"oblique",bTst:!0}]},{nType:0,sSuf:"SOU",sCom:"underline",sSty:"textDecoration",tabP:[{sVal:"underline",bTst:!0}]},{nType:0,sSuf:"BAR",sCom:"strikeThrough",sSty:"textDecoration",tabP:[{sVal:"line-through",bTst:!0}]},{nType:0,sSuf:"AGA",sCom:"JustifyLeft",sSty:"textAlign",tabP:[{sVal:"left",bTst:!0}]},{nType:0,sSuf:"ACE",sCom:"JustifyCenter",sSty:"textAlign",tabP:[{sVal:"center",bTst:!0}]},{nType:0,sSuf:"ADR",sCom:"JustifyRight",sSty:"textAlign",tabP:[{sVal:"right",bTst:!0}]},{nType:0,sSuf:"AJU",sCom:"JustifyFull",sSty:"textAlign",tabP:[{sVal:"justify",bTst:!0}]},{nType:0,sSuf:"LNU",sCom:"InsertOrderedList",sSty:"",tabP:[]},{nType:0,sSuf:"LPU",sCom:"InsertUnorderedList",sSty:"",tabP:[]},{nType:0,sSuf:"RMO",sCom:"Outdent",sSty:"",tabP:[]},{nType:0,sSuf:"RPL",sCom:"Indent",sSty:"",tabP:[]},{nType:0,sSuf:"EXP",sCom:"superscript",sSty:"",tabP:[]},{nType:0,sSuf:"IND",sCom:"subscript",sSty:"",tabP:[]},{nType:0,sSuf:"UND",sCom:"undo",tabRaccourcis:[{ctrlKey:!0,key:"z"}]},{nType:0,sSuf:"RED",sCom:"redo",tabRaccourcis:[{ctrlKey:!0,key:"y"},{shiftKey:!0,ctrlKey:!0,key:"z"}]},{nType:1,sSuf:"COF",sCom:"BackColor",sSty:"backgroundColor"},{nType:1,sSuf:"COL",sCom:"ForeColor",sSty:"color"},{nType:2,sSuf:"LNK",sCom:"OnLink"},{nType:2,sSuf:"IMG",sCom:"OnImage"},{nType:2,sSuf:"COD",sCom:"OnAfficheCodeSourceHTML"},{nType:3,sSuf:"FNA",sCom:"FontName",sSty:"fontFamily",bAvecSaisie:!0,tabP:[{sN:"Arial",sV:"Arial"},{sN:"Courier",sV:"Courier New"},{sN:"Geneva",sV:"Geneva"},{sN:"Georgia",sV:"Georgia"},{sN:"Helvetica",sV:"Helvetica"},{sN:"Tahoma",sV:"Tahoma"},{sN:"Times New Roman",sV:"Times New Roman"},{sN:"Verdana",sV:"Verdana"}]},{nType:3,sSuf:"FSI",sCom:"FontSize",sSty:"fontSize",bAvecSaisie:!0,tabP:[{sN:"1",sV:"1"},{sN:"2",sV:"2"},{sN:"3",sV:"3",bMasquerEnRelookUL:!0},{sN:"4",sV:"4"},{sN:"5",sV:"5",bMasquerEnRelookUL:!0},{sN:"6",sV:"6"},{sN:"7",sV:"7",bMasquerEnRelookUL:!0}]},{nType:3,sSuf:"FHE",sCom:"FormatBlock",sSty:"",bAvecSaisie:!1,tabP:[{sN:"div",sV:"&lt;div&gt;"},{sN:"h1",sV:"&lt;h1&gt;"},{sN:"h2",sV:"&lt;h2&gt;"},{sN:"h3",sV:"&lt;h3&gt;"},{sN:"h4",sV:"&lt;h4&gt;"},{sN:"h5",sV:"&lt;h5&gt;"},{sN:"h6",sV:"&lt;h6&gt;"},{sN:"pre",sV:"&lt;pre&gt;"}]}],n.prototype.sGetCouleurFond=function(){return this.bRelookUL()?"":WDBarre.prototype.sGetCouleurFond.apply(this,arguments)},n.prototype.Init=function(){this.__InitInterne(arguments)},n.prototype._vLiaisonHTML=function(){if(window.$){var n=this.oGetElementById(document,this.ms_sSuffixeCommande+"_BARREUL"),t=this.oGetElementById(document,this.ms_sSuffixeCommande);n&&t&&(bIEAvec11?$(n).remove():($(n).attr("id",t.id),$(t).remove()))}WDBarre.prototype._vLiaisonHTML.apply(this,arguments);this.ms_tagBoutonClic=this.bRelookUL()?"i":"img"},n.prototype.bRelookUL=function(){return window.$&&this.m_oBarre&&this.m_oBarre.tagName.toLowerCase()=="ul"},n.prototype.__InitInterne=function(n,t){var i=!!n||t;i||this.__Uninit();this.__Init1(i);i&&WDBarre.prototype.Init.apply(this,n);this.__Init2(i)},n.prototype.__Init1=function(n){if(!this.oGetTableZRParent()){if(this.m_oValeur=this.oGetElementByIdZR(document,""),this._vLiaisonHTML(),n&&this.m_oHote){var t=this.m_oHote.attributes.getNamedItem("TABINDEX");t&&(this.m_sTabIndex=t.nodeValue,this.m_oHote.removeAttribute("TABINDEX",0))}this.__InitCommun()}},n.prototype.__Uninit1=function(){this.oGetTableZRParent()||(this.__UninitCommun(),this.m_oHote&&(this.__AppliqueHoteStyleBordure(this.m_oHote),delete this.m_oHoteStyleBordure,clWDUtil.SupprimeFils(this.m_oHote)),this.m_oHote=null,delete this.m_oHote,this.m_oValeur=null,delete this.m_oValeur)},n.prototype.__Init2=function(n){this.bGestionTableZR()&&this.DeplaceBarre(this.oGetElementByIdZRIndice(document,this.nGetTableZRValeur(),this.ms_sSuffixeCommande));this.__InitHookDocumentBarre();this.m_oData&&this.m_oValeur&&this.__EcraseContenu(this.m_oValeur.value);this.RafBarre(null);this.__InitSpecifique(n)},n.prototype.__Uninit2=function(){this.__UninitSpecifique();this.__UnhookDocumentBarre()},n.prototype.__Uninit=function(){this.oGetTableZRParent()||(this.__Uninit2(),this.__Uninit1())},n.prototype.SetEtat=function(){WDBarre.prototype.SetEtat.apply(this,arguments);this.__ActiveModeEditable()},n.prototype.__ActiveModeEditable=function(){var i,n,t;switch(this.eGetEtat()){default:case WDChamp.prototype.ms_eEtatActif:i=!0;n="on";t="";break;case WDChamp.prototype.ms_eEtatLectureSeule:i=!1;n="off";t="";break;case WDChamp.prototype.ms_eEtatGrise:i=!1;n="off";t="#E0E0E0"}this.m_oData&&this.m_oDocument&&(this.__SetRegles(clWDUtil.oGetCurrentStyle(this.m_oHote).display!="none"&&n==="on"),this.m_oData.style.backgroundColor=t)},n.prototype.__SetRegles=function(n){this.m_oSaisieAPI.Set_designMode(n)},n.prototype.__ReactiveModeEditable=function(){if(this.m_oHote&&!bIEAvec11&&clWDUtil.oGetCurrentStyle(this.m_oHote).display!="none"){this.m_oDocument.designMode="off";switch(this.eGetEtat()){default:case WDChamp.prototype.ms_eEtatActif:this.__SetRegles(!0);break;case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:}}},n.prototype.__InitCommun=function(){this.bGestionTableZR()?this.__InitCommunZR():this.__InitCommunIFrame()},n.prototype.__InitCommunIFrame=function(){var t,y,i,b,k,s,e,d,h,g,v,ut,nt,ft;if(this.m_oHote){if(t=document.createElement("iframe"),t.id=this.sGetNomElement(c),t.src='javascript:""',this.__OnResize(null,t,t.style),t.frameBorder="0",t.border="0",this.m_sTabIndex&&(t.tabIndex=this.m_sTabIndex),clWDUtil.SupprimeFils(this.m_oHote),this.m_oIFrame=this.m_oHote.appendChild(t),this.m_oDocument=this.m_oIFrame.contentWindow.document,this.bRelookUL()){t.style.resize="none";t.style.verticalAlign="top";this.m_oHote.style.height.indexOf("%")==-1&&(t.style.minHeight=this.m_oHote.style.height,this.m_oHote.style.minHeight=this.m_oHote.style.height);this.m_jqGrip=$('<div class="wbSaisieRicheGrip"><\/div>');$(this.m_oHote).append(this.m_jqGrip);i=this;y=function(n){var r=$(i.m_oIFrame).height(),u=n.screenY,t=$(document.body).add(i.m_oDocument.body).add(window).on("mousemove.wb.saisieriche.grip.pendant",function(n){$(i.m_oIFrame).add(i.m_oIFrame.parentElement).css("height",r+n.screenY-u);n.stopPropagation();n.preventDefault();i._DeplaceBarre()}).on("mouseup.wb.saisieriche.grip.fin",function(){t.off("mousemove.wb.saisieriche.grip.pendant");t.off("mouseup.wb.saisieriche.grip.fin");i.m_jqGrip.one("mousedown.wb.saisieriche.grip.debut",y)})};this.m_jqGrip.one("mousedown.wb.saisieriche.grip.debut",y);i=this;$(window).on("trigger.wb.postUpdateLayoutSuperposableEpingle",function(n){i._vOnResize(n)})}var tt=this,n=[],p=[],w=[],it=_WD_;if(clWDUtil.bHTML5){if(n.push("<!DOCTYPE html>"),this.bRelookUL()){$("link").filter(function(){return this.href&&this.href.indexOf(".css")>-1&&(!tt.m_bModeSansStyleWB||this.href.indexOf("static.css")>-1)}).each(function(){w.push(this.cloneNode(!0))});$("script").filter(function(){return this.src&&(this.src.indexOf("WDUtil.js")!=-1||this.src.indexOf("WDEditeurImage")!=-1||this.src.indexOf("WWConstante")!=-1||this.src.indexOf("jquery.js")!=-1||this.src.indexOf("jquery-3.js")!=-1||this.src.indexOf("jquery-ui.js")!=-1)}).each(function(){var n;(n=this.src.indexOf("res/WDUtil.js"))!=-1&&(it=this.src.substr(0,n));p.push(this)});var o=getComputedStyle(this.m_oBarre),r=clWDUtil.tabHTML2RVBA(o.color),rt="rgba("+r[0]+", "+r[1]+", "+r[2]+", 0.15)",et="rgba("+r[0]+", "+r[1]+", "+r[2]+", 0.25)";document.head.appendChild($("<style id='wbSaisieRicheStyle-"+this.m_oBarre.id+"'>#"+this.m_oBarre.id+" .wbBarreOutilsLi:hover, .wbBarreOutilsComboListeOption:hover{background-color:"+rt+";}#"+this.m_oBarre.id+" .wbBarreOutilsLi.wbActif, #"+this.m_oBarre.id+" .wbBarreOutilComboCheckbox:checked+.wbBarreOutilComboLabelReplie>* {background-color:"+et+";}#"+this.m_oBarre.id+" .wbBarreOutilsLi:not([id])+.wbBarreOutilsLi:not([id])>label>* { border-left: 1px solid "+o.borderColor+"; }}<\/style>").get(0));w.push($("<style>.wbSaisieRicheBarre{ background-color:"+o.backgroundColor+";border-color:"+o.borderColor+";}.wbBarreOutilsMiniBarreLi:hover{background-color:"+rt+";}<\/style>").get(0))}}else n.push('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">');for(n.push(clWDUtil.bRTL?'<html dir="rtl">':"<html>"),n.push('<head xmlns="http://www.w3.org/1999/xhtml">'),n.push('<style type="text/css">body{margin:0;padding:2px;overflow:auto;}html{height: 100%;overflow:hidden;}body{height:100%;box-sizing:border-box !important;}'),b=clWDUtil.sGetCSSTexte("#"+this.m_oHote.id+" p"),""!=b&&(n.push("p{"),n.push(b),n.push("}")),n.push("<\/style>"),n.push('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><base target="_blank" /><base href="'),n.push(it),n.push('" />'),k=n.join(""),k+="<\/head><body><\/body><\/html>",this.m_oSaisieAPI=new WDSaisieAPI(!0,this.m_oIFrame,{domStyleCommun:w,bEnModeMail:this.m_bModeEmail,innerHTML:k,bGestionImages:!0,bGestionLiens:!0,bGestionTables:!0,onTab:function(n){$(tt.m_oIFrame).emulateTab(n?1:-1)}}),this.m_oData=this.m_oDocument.body,this.m_oDocument.documentElement.wdSaisieRiche=this,s=0;s<p.length;++s)e=document.createElement("script"),e.async=!1,e.defer=!1,e.src=p[s].src,this.m_oDocument.head.appendChild(e);if(d=clWDUtil.oGetCurrentStyle(this.m_oHote),h={},u(d,l,h,!1),u(d,a,h,!0),this.m_oHoteStyleBordure=h,this.__AppliqueHoteStyleBordure(this.m_oData),this.m_oHote.clientHeight&&(this.m_oHote.style.border="0px solid transparent",this.m_oHote.style.padding="0px 0px 0px 0px"),this.__CopieStyleBase(),this.m_oValeur)for(g=this.m_oValeur.attributes,ut=g.length,v=0;v<ut;v++){var ot=g.item(v),st=clWDUtil.sGetAttributNom(ot),f=st.toLowerCase();f.substr(0,2)==="on"&&(f.indexOf("onselect")===0?this.m_oDocument.addEventListener("selectionchange",this.m_oValeur.onselect):(f.indexOf("onmouse")===0||f.indexOf("onkey")===0)&&this.m_oDocument.body.addEventListener(f.substr(2),this.m_oValeur[f]))}window.$&&(nt=$(this.m_oIFrame).closest(".wbLibChamp"+this.m_sAliasChamp),nt.length&&nt.trigger("trigger.wb.saisie.rwd.riche",this.m_oIFrame));window.NSPCS&&(ft=this.m_sAliasChamp,this.m_oData.addEventListener("input",function(){NSPCS.NSChamps.OnInputModification(ft)}))}},n.prototype.__AppliqueHoteStyleBordure=function(n){var t=this.m_oHoteStyleBordure;for(var i in t)t.hasOwnProperty(i)&&(n.style[i]=t[i])},n.prototype.__InitCommunZR=function(){this.PourToutesLignesTableZR(this.__InitCommunZR_CB,this.nGetTableZRValeur())},n.prototype.__InitCommunZR_CB=function(n,t){n!=t?this.__InitCommunZR_HTML(n):this.__InitCommunZR_IFrame(n)},n.prototype.__InitCommunZR_IFrame=function(){this.m_oHote&&this.__InitCommunIFrame()},n.prototype.__InitCommunZR_HTML=function(n){var i=this.oGetElementByIdZRIndice(document,n,""),t=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote),r,u;i&&t&&(r=i.attributes.getNamedItem("DISABLED"),t.style.backgroundColor=r&&r.specified?"#E0E0E0":"",t.style.overflow="auto",t.innerHTML=i.value,u=this,t.onclick=function(t){u.OnClickLigne(t||event,n)})},n.prototype.__UninitCommun=function(){this.bGestionTableZR()&&this.__UninitCommunZR();this.m_oData=null;delete this.m_oData;this.m_oDocument=null;delete this.m_oDocument;this.m_oIFrame=null;delete this.m_oIFrame},n.prototype.__UninitCommunZR=function(){this.PourToutesLignesTableZR(this.__UninitCommunZR_HTML)},n.prototype.__UninitCommunZR_HTML=function(n){var t=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote);t&&(clWDUtil.SupprimeFils(t),t.onclick=null)},n.prototype.__InitSpecifique=function(){var t,n,i;this.m_oValeur&&(t=!1,n=this.m_oValeur.attributes.getNamedItem("READONLY"),n&&n.specified&&(WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatLectureSeule]),t=!0),i=!1,n=this.m_oValeur.attributes.getNamedItem("DISABLED"),n&&n.specified&&(WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatGrise]),i=!0),t||i||this.ms_eEtatActif==this.eGetEtat()||WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatActif]));this.__ActiveModeEditable();this.__SetMinHeight();this.m_oDocument&&clWDUtil.AttacheDetacheEvent(!0,this.m_oDocument,"keydown",this.m_fKeyDown)},n.prototype.__UninitSpecifique=function(){this.m_oDocument&&clWDUtil.AttacheDetacheEvent(!1,this.m_oDocument,"keydown",this.m_fKeyDown)},n.prototype.__CopieStyleBase=function(){var f=clWDUtil.oGetCurrentStyle(this.m_oData),t=clWDUtil.oGetCurrentStyle(this.m_oHote),e=this.m_oData.style,n,i,r,u;for(n in t)if((!bFF||!t.hasOwnProperty(n))&&(i=t[n],"string"==typeof i)){if("border"===n.substr(0,6)||"padding"===n.substr(0,7)||"outline"===n||"margin"===n.substr(0,6)||"overflow"===n.substr(0,8)||"width"===n||"height"===n||"cssText"===n||"background"===n||"font"===n||"webkitBorder"===n.substr(0,12)||"webkitPadding"===n.substr(0,13)||"webkitLogical"===n.substr(0,13)||"visibility"===n||"color"===n||"webkitUserModify"===n)continue;else"lineHeight"===n&&(r=parseInt(t.lineHeight),u=parseInt(t.fontSize),isNaN(r)||isNaN(u)||(i=r/u));f[n]!==i&&(e[n]=i)}},n.prototype.__RafBarreMasqueAutre=function(n){return AppelMethode("RafBarre",[n],this),this.RafBarre(n,!0)},n.prototype._InitBarreAutomatique=function(){clWDUtil.AttacheDetacheEvent(!0,document,"click",this.m_fRafBarreSans);clWDUtil.AttacheDetacheEvent(!0,document,"keyup",this.m_fRafBarreSans)},n.prototype.__InitHookDocumentBarre=function(){var n=bIEAvec11?this.m_oData:this.m_oDocument;n&&(clWDUtil.AttacheDetacheEvent(!0,n,"click",this.m_fRafBarreTrueMasqueAutre),clWDUtil.AttacheDetacheEvent(!0,n,"keyup",this.m_fRafBarreTrueMasqueAutre))},n.prototype.__UnhookDocumentBarre=function(){var n=bIEAvec11?this.m_oData:this.m_oDocument;n&&(clWDUtil.AttacheDetacheEvent(!1,n,"click",this.m_fRafBarreTrueMasqueAutre),clWDUtil.AttacheDetacheEvent(!1,n,"keyup",this.m_fRafBarreTrueMasqueAutre))},n.prototype._voNewBoutonOnOff=function(n,t){return new o(this,n,t.sCom,t.sSty,t.tabP)},n.prototype._voNewBoutonPopup=function(n,t){var i=t.sSuf+"P";return new s(this,n,t.sCom,this.oGetElementByIdBarre(document,i),i,t.sSty)},n.prototype._voNewBoutonAction=function(n,t){return new e(this,n,t.sCom)},n.prototype._voNewBoutonCombo=function(n,i){return this.bRelookUL()?new h(this,n,i.sCom,i.sSty,i.tabP,i.sSuf,i.bAvecSaisie):new t(this,n,i.sCom,i.sSty,i.tabP,i.sSuf)},n.prototype._AssocieBarreElements=function(){this.bRelookUL()&&(this.m_tabDescBarre.push({nType:3,sSuf:"EMO",sCom:"wbEmoji",tabP:v,nIndiceSelectionDefaut:9}),this.m_tabDescBarre.push({nType:1,sSuf:"TAB",sCom:"wbInsertTable"}));WDBarre.prototype._AssocieBarreElements.apply(this,arguments);this.bRelookUL()&&(bIEAvec11||bEdge||$(".wbBarreOutilsImgPlanche").addClass("wbBarreOutilsImgPlancheSVG"))},n.prototype.OnClickLigne=function(n,t){this.bSauveContenu(n);this._OnClickLigneRetarde(n,t)},n.prototype._OnClickLigneRetarde=function(n,t){var i=this.oGetTableZRParent();if(i&&i.m_oCache&&i.m_oCache.m_tabRequetes.length>0){this.nSetTimeout(this._OnClickLigneRetarde,clWDUtil.ms_oTimeoutImmediat,null,t);return}this.SetTableZRValeur(n,t);this.__InitInterne()},n.prototype._vOnResize=function(n){if(WDBarre.prototype._vOnResize.apply(this,arguments),this.m_oDocument&&this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!0)){this.m_oIFrame&&!this.bGetTimeXXXExiste("__OnResizeInterneS1")&&this.__OnResize(n,this.m_oIFrame,clWDUtil.oGetCurrentStyle(this.m_oIFrame));(bIEAvec11||bEdge)&&this.__CopieStyleBase();this.__SetMinHeight();var t=this.m_oBarre&&this.m_oBarre.style.opacity!=="0"&&clWDUtil.bEstDisplay(this.m_oBarre,document,!0);t&&this.__RafBarreMasqueAutre(n)}},n.prototype.__SetMinHeight=function(){if((clWDUtil.bHTML5||bFF)&&this.m_oData){(bFF||clWDUtil.bHTML5)&&!bIE&&"100%"==this.m_oHote.parentNode.parentNode.parentNode.parentNode.style.height&&(this.m_oIFrame.style.minHeight="0",this.m_oIFrame.style.minHeight=this.m_oHote.parentNode.offsetHeight-3+"px");this.m_oData.style.minHeight="0";var n=clWDUtil.oGetCurrentStyle(this.m_oData),t=n?this.s_nGetOffsetBorderPourHeight(n):0;this.m_oData.style.minHeight=this.m_oIFrame.offsetHeight-4-t+"px"}},n.prototype.__OnResize=function(n,t,i){var r=this.s_nGetOffsetBorderPourWidth(i),u=this.s_nGetOffsetBorderPourHeight(i);if(bIEQuirks){if(this.m_oIFrame==t&&clWDUtil.oSupprimeElement(t),n){var f=clWDUtil.oGetCurrentStyle(this.m_oHote),e=f.width,o=f.height;this.m_oHote.style.width="1px";this.m_oHote.style.height="1px";this.nSetTimeoutUnique("__OnResizeInterneS1",clWDUtil.ms_oTimeoutNonImmediat200,r,u,e,o,t);return}}else{t.style.width="100%";t.style.height="100%";return}this.__OnResizeInterne(t,r,u)},n.prototype.__OnResizeInterneS1=function(n,t,i,r,u){this.m_oHote.style.width=i;this.m_oHote.style.height=r;this.__OnResizeInterne(u,n,t)},n.prototype.__OnResizeInterne=function(n,t,i){var r=this.m_oHote.offsetWidth-t,u=this.m_oHote.offsetHeight-i;bIEQuirks&&this.m_oIFrame==n&&this.m_oHote.appendChild(n);n.style.width=(r>=0?r:0)+"px";n.style.height=(u>=0?u:0)+"px";this._DeplaceBarre()},n.prototype.OnDisplay=function(n,t){if(undefined===this.m_tabBarreElements&&this.Init(),WDBarre.prototype.OnDisplay.apply(this,arguments),!1!==(t&&this.m_oHote&&clWDUtil.bEstFils(this.m_oHote,n))){for(var r=!0,u=!1,f=n.getElementsByTagName("iframe"),e=f.length,i=0;i<e;i++)if(this.m_oDocument==f[i].contentWindow.document){u=!0;break}u||(this.__InitInterne(undefined,!0),r=!1);this.m_oDocument&&(this.m_oDocument.body&&(this.m_oDocument.body.style.visibility=""),this.__ReactiveModeEditable());r&&this._vOnResize(null)}},n.prototype._vOnTableZRAfficheAJAXInterne=function(){WDBarre.prototype._vOnTableZRAfficheAJAXInterne.apply(this,arguments);this.__InitInterne()},n.prototype._vOnLigneTableZRAffiche=function(n,t){WDBarre.prototype._vOnLigneTableZRAffiche.apply(this,arguments);var i=this.oGetTableZRParent();t||i&&i.bLigneEstSelectionnee(n-1,NaN)?(this.m_oValeur=this.oGetElementByIdZRIndice(document,n,""),this.m_oHote=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote),this.__InitCommunZR_IFrame(n-1),this.DeplaceBarre(this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeCommande)),this.__InitHookDocumentBarre(),this.m_oData&&this.m_oValeur&&this.__EcraseContenu(this.m_oValeur.value),this.RafBarre(null),this.__InitSpecifique(!1)):this.__InitCommunZR_HTML(n)},n.prototype._vOnLigneTableZRMasque=function(n,t,i){t&&(this.bSauveContenu(i),this.__UninitSpecifique(),this.__UnhookDocumentBarre());var r=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote);r&&(t&&(this.__AppliqueHoteStyleBordure(r),delete this.m_oHoteStyleBordure),clWDUtil.SupprimeFils(r),r.onclick=null);t&&(this.m_oData=null,delete this.m_oData,this.m_oDocument=null,delete this.m_oDocument,this.m_oIFrame=null,delete this.m_oIFrame,this.m_oHote=null,delete this.m_oHote,this.m_oValeur=null,delete this.m_oValeur);WDBarre.prototype._vOnLigneTableZRMasque.apply(this,arguments)},n.prototype.RafBarre=function(n,t){var i,r,u,e,o,f,s;if(this.m_oBarre){if(t===undefined){if(i=null,!bIE&&n&&(i=clWDUtil.oGetOriginalTarget(n)),!i){i=document.activeElement;try{i.parentNode}catch(h){i=null}}(i===window||clWDUtil.bEstFils(i,this.m_oBarre)||clWDUtil.bEstFils(i,this.m_oHote))&&(t=!0);r=this.oGetTableZRParent();r&&r.m_tabSelection&&r.m_oCache&&(u=r.m_oCache.oGetLigne(r.m_tabSelection[0]),u&&i==u.m_oLigneHTML.oGetLigneLogiqueHTML(u.vnGetColonneHTML())&&(t=!0))}if(t?this.OnFocus(n):this.OnBlur(n),t&&this.AppelMethodeAutresPtr(WDChamp.prototype.MasqueBarre,[n]),e=t,this.m_eModeBarre!=this.ms_eModeBarreAutomatique&&(t=undefined),!this.bRelookUL())return WDBarre.prototype.RafBarre.apply(this,[n,t]);this.eGetEtat()!=WDChamp.prototype.ms_eEtatActif&&(t=!1);switch(this.m_eModeBarre){case this.ms_eModeBarreJamais:break;case this.ms_eModeBarreAutomatique:default:if(this.m_oBarre.style.display="block",this.m_oBarre.style.opacity=t?1:0,this.m_oBarre.style.pointerEvents=t?"all":"none",this.m_oBarre.style.position=t?"absolute":"fixed",!t)break;case this.ms_eModeBarreToujours:for(this._DeplaceBarre(),this.m_bBarreDeplacee&&(this.m_oBarre.style.display="block",t=!(!e&&!clWDUtil.bEstDisplay(this.m_oHote,document,!0)),this.m_oBarre.style.opacity=t?1:0,this.m_oBarre.style.pointerEvents=t?"all":"none"),o=this.oGetParamEtat(n,!1),s=this.m_tabBarreElements.length,f=0;f<s;f++)this.m_tabBarreElements[f].RafEtat(n,o)}}},n.prototype._DeplaceBarreSiBesoinAvecTimeout=function(){var n=this.m_oBarre&&this.m_oBarre.style.opacity!=="0"&&clWDUtil.bEstDisplay(this.m_oBarre,document,!0);this.m_bBarreDeplacee&&n&&this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!0)&&this._DeplaceBarre()},n.prototype._DeplaceBarre=function(){var n,f,e,r,u,t,i;if(this.m_oBarre){if(!this.bRelookUL()){this.m_oBarre.style.bottom="auto";WDBarre.prototype._DeplaceBarre.apply(this,arguments);return}if(this.m_oHote&&this.m_bBarreDeplacee){n={};n.top="auto";n.left="auto";n.marginTop=0;f=$(this.m_oHote).closest(".dzSpanRiche,.dzSpan,.dzSpanRiche>span,.dzSpan>span");f.length?(this.m_oBarre.parentElement!=this.m_oHote.parentElement&&(e=$(this.m_oBarre).detach(),$(this.m_oHote.parentElement).css("position","relative").prepend(e)),n.marginTop=parseInt(this.m_oData.style.borderTopWidth),n.marginTop&&(n.marginTop+="px"),n.transform="translateY(-100%)",n.width="100%"):this.m_oHote&&this.m_oData&&(n.left=clWDUtil.nGetBoundingClientRectLeft(this.m_oHote,!0,!1)+"px",n.width=this.m_oHote.getBoundingClientRect().width+"px",r=document.body.getBoundingClientRect().height,u=r-clWDUtil.nGetBoundingClientRectTop(this.m_oHote,!0,!1)-parseInt(this.m_oData.style.borderTopWidth),n.bottom=u+"px",bTouchMobile||(this.m_oBarre.style.width=n.width,t=u,t=Math.min(t,r-$(window).scrollTop()-this.m_oBarre.clientHeight),t=Math.max(t,r-($(this.m_oHote).offset().top+this.m_oHote.clientHeight)),n.transform="translateY("+(u-t)+"px)"),this.rafDeplaceBarre&&cancelAnimationFrame(this.rafDeplaceBarre));for(i in n)this.m_oDernierePositionBarre&&this.m_oDernierePositionBarre[i]==n[i]||(this.m_oBarre.style[i]=n[i]);this.m_oDernierePositionBarre=n}}},n.prototype.OnFocus=function(n){this.m_bFocus||(this.m_bFocus=!0,this.RecuperePCode(this.ms_nEventNavFocus)(n))},n.prototype.OnBlur=function(n){this.m_bFocus&&(this.__SauveContenuAvecOnChange(n),this.RecuperePCode(this.ms_nEventNavBlur)(n),delete this.m_bFocus)},n.prototype.__SauveContenuAvecOnChange=function(n){if(this.bSauveContenu(n)){var t=this.RecuperePCode(this.ms_nEventNavChange);t!=clWDUtil.m_pfVide&&t(n)}},n.prototype.bOnKeyDown=function(n){var f,t,e,i,c,o,u,l,r,s,h;if(n.keyCode==13){if(!bIE||bIE11Plus||this.m_bBaliseP)!bIE&&(bIE11Plus||bEdge)&&this.m_bBaliseP?(t=this.oGetRange(),t&&(e=t.startContainer,e&&e==t.endContainer&&(i=e.nextSibling,i&&clWDUtil.bBaliseEstTag(i,"br")&&!i.nextSibling&&i.parentNode.removeChild(i)))):bFF&&this.m_bBaliseP?this.m_oDocument.execCommand("formatBlock",!1,"p"):bCrm&&this.m_bBaliseP&&(c=this.m_oDocument.body.childNodes,1==c.length&&c[0].nodeName=="#text"&&this.m_oDocument.execCommand("formatBlock",!1,"p"));else if(t=this.oGetRange(),t&&t.duplicate)return t.parentElement&&(f=t.parentElement(),f&&(clWDUtil.bBaliseEstTag(f,"ul")||clWDUtil.bBaliseEstTag(f,"li")))?!0:(t.pasteHTML("<br>"),t.moveStart("character",1),t.moveEnd("character",2),t.select(),t.collapse(!1),t.scrollIntoView(),clWDUtil.bStopPropagation(n))}else if(this.bRelookUL())for(o=this,l=o.m_tabDescBarre.length,u=0;u<l;u++)if(r=o.m_tabDescBarre[u],r&&r.tabRaccourcis&&r.tabRaccourcis.length)for(s=0;s<r.tabRaccourcis.length;++s)if(h=r.tabRaccourcis[s],n.ctrlKey===!!h.ctrlKey&&n.shiftKey===!!h.shiftKey&&n.key===h.key){o.m_tabBarreElements[u].m_oBouton.onclick(n);n.stopPropagation();n.preventDefault()}return!0},n.prototype.oGetParamEtat=function(n,t){if(this.bGestionTableZR()&&!this.m_oDocument)return[null,null,null];var i=[this.oGetRange(),null,null],r=null;return bIE&&!i[0].duplicate&&(r=i[0].item(0),i[0]=null),t==!1&&(i[1]=r?r:this.oGetSelection(i[0]),i[2]=i[1]&&this.m_oDocument!==i[1]?clWDUtil.oGetCurrentStyle(i[1]):null),i},n.prototype.__oGetSelection=function(){var n=this.m_oDocument,t=n.defaultView;return t&&t.getSelection?t.getSelection():n.getSelection?n.getSelection():undefined},n.prototype.oGetRange=function(){if(bIE)return this.m_oDocument.selection.createRange();var n=this.__oGetSelection();return n&&n.rangeCount?n.getRangeAt(0):null},n.prototype.oGetRangeCpy=function(){var n=this.oGetRange();return bIE?n.duplicate():(n&&n.cloneRange(),null)},n.prototype.oGetSelection=function(n){if(bIE){n=n.duplicate();n.collapse(!0);var t=n.parentElement();return t.document==this.m_oDocument?t:this.m_oData}return n?n.startContainer:null},n.prototype.OptimiseContenu=function(){},n.prototype.__EcraseContenu=function(n){if(this.m_oSaisieAPI&&this.m_oSaisieAPI.SetProp_ValeurBodyInner?this.m_oSaisieAPI.SetProp_ValeurBodyInner(n):this.m_oData.innerHTML=n,window.$){var t=$(this.m_oIFrame).closest(".wbLibChamp"+this.m_sAliasChamp);t.length&&t.trigger("trigger.wb.saisie.rwd.valeurinitDepuisConteneur")}},n.prototype.bSauveContenu=function(n){var r=!1,i,t;return this.m_oValeur&&(this.OptimiseContenu(),i=this.m_oValeur.value,t=this.m_oSaisieAPI&&this.m_oSaisieAPI.GetProp_ValeurBodyInner?this.m_oSaisieAPI.GetProp_ValeurBodyInner():this.m_oData.innerHTML,this.m_oValeur.value=t,r=i!=t,i.toUpperCase()!=t.toUpperCase()&&this._OnChampModifie(n,t)),r},n.prototype.SetValeur=function(n,t){return WDBarre.prototype.SetValeur.apply(this,arguments),this.__EcraseContenu(t),this.bSauveContenu(),this.__ReactiveModeEditable(),this.m_oValeur.value},n.prototype.GetValeur=function(){return this.bSauveContenu(),this.m_oValeur.value},n.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_TEXTESANSFORMAT:return this.m_oData?this.m_oData.innerText:"";default:return WDBarre.prototype.GetProp.apply(this,arguments)}},n.prototype.SetProp=function(n,t,i){i=WDBarre.prototype.SetProp.apply(this,arguments);switch(n){case this.XML_CHAMP_PROP_NUM_COULEUR:return this.m_oDocument.body.style.color=i,i;case this.XML_CHAMP_PROP_NUM_COULEURFOND:return this.m_oDocument.body.style.backgroundColor=i,i;case this.XML_CHAMP_PROP_NUM_ETAT:return this.__InitSpecifique(!1),i;default:return i}},n.prototype.OnSubmit=function(n){WDBarre.prototype.OnSubmit.apply(this,arguments);this.__SauveContenuAvecOnChange(n)},n.prototype.SetFocus=function(){bIEAvec11||this.m_oIFrame.contentWindow.focus();this.m_oData.focus();this.RafBarre(null)},n.prototype.AjouteTable=function(n){for(var i,t='<br /><table align="center" width="80%" style="border-collapse:collapse;table-layout:fixed;">',r=0;r<n[2][1];++r){for(t+="<tr>",i=0;i<n[2][0];++i)t+='<td style="border:1px solid #808080;"><br /><\/td>';t+="<\/tr>"}t+="<\/table><br />";this.m_oSaisieAPI.CMD_InsereTableauHTML(t,n[3])},n.prototype.AjouteEmoji=function(n){this.m_oSaisieAPI.CMD_InsereHtml(n[2],!0)},n.prototype.ExecuteCommande=function(n,t){this.SetFocus();switch(this.bRelookUL()?t[0]:""){case"bold":this.m_oSaisieAPI.CMD_Gras();break;case"italic":this.m_oSaisieAPI.CMD_Italique();break;case"underline":this.m_oSaisieAPI.CMD_Souligne();break;case"strikeThrough":this.m_oSaisieAPI.CMD_Barre();break;case"JustifyLeft":this.m_oSaisieAPI.CMD_AligneGauche();break;case"JustifyCenter":this.m_oSaisieAPI.CMD_AligneCentre();break;case"JustifyRight":this.m_oSaisieAPI.CMD_AligneDroite();break;case"JustifyFull":this.m_oSaisieAPI.CMD_AligneJustifie();break;case"InsertOrderedList":this.m_oSaisieAPI.CMD_CreePuceAvecNumero();break;case"InsertUnorderedList":this.m_oSaisieAPI.CMD_CreePuceSansNumero();break;case"Outdent":this.m_oSaisieAPI.CMD_DiminueRetrait();break;case"Indent":this.m_oSaisieAPI.CMD_AugmenteRetrait();break;case"superscript":this.m_oSaisieAPI.CMD_Exposant();break;case"subscript":this.m_oSaisieAPI.CMD_Indice();break;case"undo":this.m_oSaisieAPI.CMD_Annuler();break;case"redo":this.m_oSaisieAPI.CMD_Retablir();break;case"BackColor":this.m_oSaisieAPI.CMD_ChangeCouleurFondTexte(t[2]);break;case"ForeColor":this.m_oSaisieAPI.CMD_ChangeCouleurTexte(t[2]);break;case"FontName":this.m_oSaisieAPI.CMD_ChangeNomPolice(t[2]);break;case"FontSize":var i=t[2];if(i.length&&!isNaN(parseInt(i[i.length-1])))switch(i){case"1":i="10px";break;case"2":i="13px";break;case"4":i="18px";break;case"6":i="32px";break;default:i+="px"}this.m_oSaisieAPI.CMD_ChangeTaillePolice(i);break;case"FormatBlock":this.m_oSaisieAPI.CMD_ChangeFormatBlock(t[2]);break;case"wbInsertTable":this.AjouteTable(t);break;case"wbEmoji":this.AjouteEmoji(t);break;default:t[0]==="FormatBlock"&&typeof t[2]=="string"&&(t[2]=t[2].replace("&lt;","<").replace("&gt;",">"));this.m_oDocument.execCommand(t[0],t[1],t[2])}this.SetFocus();this.RafBarre(n,!0)},n.prototype.OnLink=function(n){this.__OnPrompt(n,"CreateLink",HTML_TOOLBAR.DLG.LNK||"URL ?","http://",!1,!0)},n.prototype.OnImage=function(n){var t=this.oGetRange(),i=undefined,r;if(bIE&&!t.duplicate&&t.item(0)&&t.item(0).src&&(i=t.item(0).src),!this.bRelookUL()){this.__OnPrompt(n,"InsertImage",HTML_TOOLBAR.DLG.IMG||"Image ?",i||"http://",!0,!1);return}r=function(n){var r,u,f;n&&n!==i&&(t&&t.item&&t.item(0).src?t.item(0).src=n:(r=document.createElement("img"),r.src=n,this.bRelookUL()&&(r.style.margin="24px"),t?(t.deleteContents(),t.insertNode(r),t.collapse()):(u=this.m_oIFrame.contentWindow.getSelection(),u.anchorNode?(f=u.getRangeAt(0),f.deleteContents(),f.insertNode(r)):this.m_oIFrame.contentWindow.document.body.appendChild(r))),this.m_oSaisieAPI.NotifieApresModification())}.bind(this);n.stopPropagation();this.m_oSaisieAPI.ExecuteEditeurImage(function(){var n=window.wbEditeurImageSelectImage({onOK:function(n){n&&r(n)},onComponentDidMount:function(){$(n).hide().fadeIn().focus()}});this.m_oDocument.documentElement.wdSaisieRiche.RafBarre(undefined,!1)}.bind(this),function(){r(prompt(HTML_TOOLBAR.DLG.IMG||"Image ?",i||"http://"))}.bind(this))},n.prototype.OnAfficheCodeSourceHTML=function(n){var t,r,i;n.stopPropagation();t=this;$(t.m_oBarre).find(".wbActif").removeClass("wbActif");var u=$(n.target).add(n.target.parentElement).add(n.target.parentElement.parentElement),f=$(t.m_oBarre).children().not(u),e=f.add(f.find("i,label"));if(t.m_fTermineAffichageCodeSourceHTML){t.m_fTermineAffichageCodeSourceHTML();t.m_fTermineAffichageCodeSourceHTML=undefined;return}u.addClass("wbActif");e.addClass("wbgrise");r=function(){e.removeClass("wbgrise");t.m_oIFrame.style.opacity=1;t.m_oIFrame.style.pointerEvents="auto";t.m_valeurCodeHTML!==undefined&&(t.m_oData.innerHTML=t.m_valeurCodeHTML);t.m_valeurCodeHTML=undefined};t.m_oIFrame.style.opacity=.5;t.m_oIFrame.style.pointerEvents="none";i=document.createElement("div");i.style.opacity=0;i.style.pointerEvents="none";i.style.position="absolute";i.style.height="100%";i.style.width="100%";i.style.top=0;i.style.left=0;i.style.display="flex";i.style.flexDirection="column";i.addEventListener("click",function(){$(this).find("[contenteditable]").focus()});t.m_oIFrame.parentElement.style.position="relative";t.m_oIFrame.parentElement.append(i);t.m_oSaisieAPI.ExecuteEditeurImage(function(){var n=window.wbEditeurCode({domEditeurCode:i,value:t.m_oData.innerHTML,onChange:function(n){t.m_valeurCodeHTML=n},onComponentDidMount:function(){t.m_oIFrame.style.opacity=0;i.style.pointerEvents="auto";i.style.opacity=1}});t.m_fTermineAffichageCodeSourceHTML=function(){n();r()}}.bind(this),function(){r()}.bind(this))},n.prototype.__OnPrompt=function(n,t,i,r,u,f){var e,h,c,o,s;bIE&&!u?this.ExecuteCommande(n,[t,!0,""]):(e=prompt(i,r),e&&e!=r&&(f&&!bIEAvec11&&(h=this.oGetRange(),h.collapsed&&(c=this.m_oIFrame.contentWindow.getSelection(),o=c.getRangeAt(0),o.deleteContents(),s=document.createElement("span"),s.innerText=e,o.insertNode(s))),this.ExecuteCommande(n,[t,!1,e])))},n.prototype.sGetAltText=function(n){return HTML_TOOLBAR.ALTTEXT[n]},n.prototype.RAZIndication=clWDUtil.m_pfVide,n}()